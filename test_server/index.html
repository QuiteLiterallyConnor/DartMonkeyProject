<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebRTC Livestream</title>
</head>
<body>
<video autoplay playsinline controls></video>

<script>
    const configuration = {'iceServers': [{'urls': 'stun:stun.l.google.com:19302'}]};
    const pc = new RTCPeerConnection(configuration);

    pc.ontrack = function (event) {
        const stream = event.streams[0];
        const video = document.querySelector('video');
        video.srcObject = stream;
    };

    const offerOptions = {
        offerToReceiveAudio: false,
        offerToReceiveVideo: true
    };

    pc.createOffer(offerOptions).then(function (offer) {
        return pc.setLocalDescription(offer);
    }).then(function () {
        return fetch('/offer', {
            method: 'POST',
            body: JSON.stringify(pc.localDescription),
            headers: {
                'Content-Type': 'application/json'
            }
        });
    }).then(function (response) {
        return response.json();
    }).then(function (answer) {
        return pc.setRemoteDescription(answer);
    }).catch(function (e) {
        console.error(e);
    });
</script>
</body>
</html>
